<taglib name="html" />	
<content>
<div style="float:left;margin-bottom: 10px;">
<a class="btn btn-success add">添加中奖用户</a>
</div>

<div style="clear:both;"></div>
	<table class="table table-bordered table-hover">
		<tr>
			<th width="70px">序号</th>
			<th>中奖昵称</th>
			<th>中奖时间</th>
			<th >操作</th>
		</tr>
		<tbody>
			<volist name="list" id="vo" key="k">
				<tr>
				<td>{$k}</td>
				<td>{$vo.nickname}</td>
				<td>{$vo.time|date="Y-m-d H:i:s",###}</td>
				<td width="150px"><a zj_id="{$vo.zj_id}" nickname="{$vo.nickname}" class="btn btn-info edit">编辑</a><a class="btn btn-danger del" zj_id={$vo.zj_id} style="margin-left: 10px;">删除</a></td>
			</tr>
			</volist>
		</tbody>
	</table>
</content>
<script type="text/javascript">
	$('.add').click(function(){
		layer.open({
		  type: 1,
		  title:"添加中奖用户",
		  scrollbar: false,
		  skin: 'layui-layer-rim', //加上边框
		  area: ['300px', '180px'], //宽高
		  content: '<div style="width:90%;text-align:center;margin-top:20px;"><form class="form-horizontal"><div class="form-group"><label class="col-sm-4 control-label">中奖昵称</label><input name="type" type="hidden" value="1"><input name="nickname" type="text" style="width:150px" class="col-sm-4 form-control" placeholder="输入中奖昵称"></div></form><a style="width:100px;" class="btn btn-success" onclick="add()">确定</a>&nbsp;&nbsp;<a style="width:100px;" class="btn btn-default" onclick="cancel()">取消</a></div>',
		});
	});
	function add(){
		var nickname=$('input[name=nickname]').val();
		var type=$('input[name=type]').val();
		if(nickname==""){
			layer.msg('请输入完整信息',{icon:0});
			return false;
		}
		$.post("{:U('zhongjian_add')}",{nickname:nickname,type:type},function(data){
			if(data.status){
				layer.msg(data.info,{icon:1});
				setTimeout(function(){
					window.location.reload(0);
				},1000);
			}
			else{
				layer.msg(data.info,{icon:0});
			}
		});
	}
	function cancel(){
		layer.closeAll();
	}
	
	$('.edit').click(function(){

		var nickname=$(this).attr('nickname');
		var zj_id=$(this).attr('zj_id');
		layer.open({
		  type: 1,
		  title:"添加等级",
		  scrollbar: false,
		  skin: 'layui-layer-rim', //加上边框
		  area: ['300px', '180px'], //宽高
		  content: '<div style="width:90%;text-align:center;margin-top:20px;"><form class="form-horizontal"><div class="form-group"><input name="zj_id" type="hidden" value="'+zj_id+'"><label class="col-sm-4 control-label">中奖昵称</label><input name="nickname" value="'+nickname+'" type="text" style="width:150px" class="col-sm-4 form-control" placeholder="昵称"></div></form><a style="width:100px;" class="btn btn-success" onclick="edit()">确定</a>&nbsp;&nbsp;<a style="width:100px;" class="btn btn-default" onclick="cancel()">取消</a></div>',
		});
	});
	function edit(){
		var zj_id=$('input[name=zj_id]').val();
		var nickname=$('input[name=nickname]').val();
		if(nickname==""){
			layer.msg('请输入完整信息',{icon:0});
			return false;
		}
		$.post("{:U('zhongjian_edit')}",{zj_id:zj_id,nickname:nickname},function(data){
			if(data.status){
				layer.msg(data.info,{icon:1});
				setTimeout(function(){
					window.location.reload(0);
				},1000);
			}
			else{
				layer.msg(data.info,{icon:0});
			}
		});
	}

	$('.del').click(function(){
		var zj_id=$(this).attr('zj_id');
		layer.confirm('您确定要【<span style="color:red">删除</span>】?',{
			title:'温馨提醒',
			btn:['确定','取消'],
			},function(){
				layer.load();
				$.post("{:U('kanzhong_del')}",{zj_id:zj_id},function(data){
					layer.closeAll('loading');
					if(data.status){
						layer.msg(data.info,{icon:1});
						setTimeout(function(){
							window.location.reload(0);
						},1000);
					}
					else{
						layer.msg(data.info,{icon:0});
					}
				});
			},
			function(){
				layer.closeAll();
			}
		);
	});
</script>